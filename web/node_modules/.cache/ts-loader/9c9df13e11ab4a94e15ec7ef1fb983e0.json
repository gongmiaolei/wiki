{"remainingRequest":"/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/ts-loader/index.js??ref--13-1!/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/gongmiaolei/Downloads/jiawawiki/web/src/views/doc.vue?vue&type=script&lang=ts","dependencies":[{"path":"/Users/gongmiaolei/Downloads/jiawawiki/web/src/views/doc.vue","mtime":1614134929000},{"path":"/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/cache-loader/dist/cjs.js","mtime":1678346314360},{"path":"/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/ts-loader/index.js","mtime":1678346315105},{"path":"/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/cache-loader/dist/cjs.js","mtime":1678346314360},{"path":"/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":1678346314907}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgZGVmaW5lQ29tcG9uZW50LCBvbk1vdW50ZWQsIHJlZiB9IGZyb20gJ3Z1ZSc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IG1lc3NhZ2UgfSBmcm9tICdhbnQtZGVzaWduLXZ1ZSc7CmltcG9ydCB7IFRvb2wgfSBmcm9tICJAL3V0aWwvdG9vbCI7CmltcG9ydCB7IHVzZVJvdXRlIH0gZnJvbSAidnVlLXJvdXRlciI7CmV4cG9ydCBkZWZhdWx0IGRlZmluZUNvbXBvbmVudCh7CiAgICBuYW1lOiAnRG9jJywKICAgIHNldHVwOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHJvdXRlID0gdXNlUm91dGUoKTsKICAgICAgICB2YXIgZG9jcyA9IHJlZigpOwogICAgICAgIHZhciBodG1sID0gcmVmKCk7CiAgICAgICAgdmFyIGRlZmF1bHRTZWxlY3RlZEtleXMgPSByZWYoKTsKICAgICAgICBkZWZhdWx0U2VsZWN0ZWRLZXlzLnZhbHVlID0gW107CiAgICAgICAgLy8g5b2T5YmN6YCJ5Lit55qE5paH5qGjCiAgICAgICAgdmFyIGRvYyA9IHJlZigpOwogICAgICAgIGRvYy52YWx1ZSA9IHt9OwogICAgICAgIC8qKgogICAgICAgICAqIOS4gOe6p+aWh+aho+agke+8jGNoaWxkcmVu5bGe5oCn5bCx5piv5LqM57qn5paH5qGjCiAgICAgICAgICogW3sKICAgICAgICAgKiAgIGlkOiAiIiwKICAgICAgICAgKiAgIG5hbWU6ICIiLAogICAgICAgICAqICAgY2hpbGRyZW46IFt7CiAgICAgICAgICogICAgIGlkOiAiIiwKICAgICAgICAgKiAgICAgbmFtZTogIiIsCiAgICAgICAgICogICB9XQogICAgICAgICAqIH1dCiAgICAgICAgICovCiAgICAgICAgdmFyIGxldmVsMSA9IHJlZigpOyAvLyDkuIDnuqfmlofmoaPmoJHvvIxjaGlsZHJlbuWxnuaAp+WwseaYr+S6jOe6p+aWh+ahowogICAgICAgIGxldmVsMS52YWx1ZSA9IFtdOwogICAgICAgIC8qKgogICAgICAgICAqIOWGheWuueafpeivogogICAgICAgICAqKi8KICAgICAgICB2YXIgaGFuZGxlUXVlcnlDb250ZW50ID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICAgIGF4aW9zLmdldCgiL2RvYy9maW5kLWNvbnRlbnQvIiArIGlkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgICAgaWYgKGRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIGh0bWwudmFsdWUgPSBkYXRhLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLmVycm9yKGRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgLyoqCiAgICAgICAgICog5pWw5o2u5p+l6K+iCiAgICAgICAgICoqLwogICAgICAgIHZhciBoYW5kbGVRdWVyeSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYXhpb3MuZ2V0KCIvZG9jL2FsbC8iICsgcm91dGUucXVlcnkuZWJvb2tJZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICBkb2NzLnZhbHVlID0gZGF0YS5jb250ZW50OwogICAgICAgICAgICAgICAgICAgIGxldmVsMS52YWx1ZSA9IFtdOwogICAgICAgICAgICAgICAgICAgIGxldmVsMS52YWx1ZSA9IFRvb2wuYXJyYXkyVHJlZShkb2NzLnZhbHVlLCAwKTsKICAgICAgICAgICAgICAgICAgICBpZiAoVG9vbC5pc05vdEVtcHR5KGxldmVsMSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFNlbGVjdGVkS2V5cy52YWx1ZSA9IFtsZXZlbDEudmFsdWVbMF0uaWRdOwogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVRdWVyeUNvbnRlbnQobGV2ZWwxLnZhbHVlWzBdLmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yid5aeL5pi+56S65paH5qGj5L+h5oGvCiAgICAgICAgICAgICAgICAgICAgICAgIGRvYy52YWx1ZSA9IGxldmVsMS52YWx1ZVswXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLmVycm9yKGRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgdmFyIG9uU2VsZWN0ID0gZnVuY3Rpb24gKHNlbGVjdGVkS2V5cywgaW5mbykgewogICAgICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0ZWQnLCBzZWxlY3RlZEtleXMsIGluZm8pOwogICAgICAgICAgICBpZiAoVG9vbC5pc05vdEVtcHR5KHNlbGVjdGVkS2V5cykpIHsKICAgICAgICAgICAgICAgIC8vIOmAieS4reafkOS4gOiKgueCueaXtu+8jOWKoOi9veivpeiKgueCueeahOaWh+aho+S/oeaBrwogICAgICAgICAgICAgICAgZG9jLnZhbHVlID0gaW5mby5zZWxlY3RlZE5vZGVzWzBdLnByb3BzOwogICAgICAgICAgICAgICAgLy8g5Yqg6L295YaF5a65CiAgICAgICAgICAgICAgICBoYW5kbGVRdWVyeUNvbnRlbnQoc2VsZWN0ZWRLZXlzWzBdKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgLy8g54K56LWeCiAgICAgICAgdmFyIHZvdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGF4aW9zLmdldCgnL2RvYy92b3RlLycgKyBkb2MudmFsdWUuaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jLnZhbHVlLnZvdGVDb3VudCsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5lcnJvcihkYXRhLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIG9uTW91bnRlZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGhhbmRsZVF1ZXJ5KCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbGV2ZWwxOiBsZXZlbDEsCiAgICAgICAgICAgIGh0bWw6IGh0bWwsCiAgICAgICAgICAgIG9uU2VsZWN0OiBvblNlbGVjdCwKICAgICAgICAgICAgZGVmYXVsdFNlbGVjdGVkS2V5czogZGVmYXVsdFNlbGVjdGVkS2V5cywKICAgICAgICAgICAgZG9jOiBkb2MsCiAgICAgICAgICAgIHZvdGU6IHZvdGUKICAgICAgICB9OwogICAgfQp9KTsK"},{"version":3,"file":"/Users/gongmiaolei/Downloads/jiawawiki/web/src/views/doc.vue.ts","sourceRoot":"","sources":["/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gongmiaolei/Downloads/jiawawiki/web/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/gongmiaolei/Downloads/jiawawiki/web/src/views/doc.vue?vue&type=script&lang=ts"],"names":[],"mappings":"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","sourcesContent":["\n  import { defineComponent, onMounted, ref, createVNode } from 'vue';\n  import axios from 'axios';\n  import {message} from 'ant-design-vue';\n  import {Tool} from \"@/util/tool\";\n  import {useRoute} from \"vue-router\";\n\n  export default defineComponent({\n    name: 'Doc',\n    setup() {\n      const route = useRoute();\n      const docs = ref();\n      const html = ref();\n      const defaultSelectedKeys = ref();\n      defaultSelectedKeys.value = [];\n      // 当前选中的文档\n      const doc = ref();\n      doc.value = {};\n\n      /**\n       * 一级文档树，children属性就是二级文档\n       * [{\n       *   id: \"\",\n       *   name: \"\",\n       *   children: [{\n       *     id: \"\",\n       *     name: \"\",\n       *   }]\n       * }]\n       */\n      const level1 = ref(); // 一级文档树，children属性就是二级文档\n      level1.value = [];\n\n      /**\n       * 内容查询\n       **/\n      const handleQueryContent = (id: number) => {\n        axios.get(\"/doc/find-content/\" + id).then((response) => {\n          const data = response.data;\n          if (data.success) {\n            html.value = data.content;\n          } else {\n            message.error(data.message);\n          }\n        });\n      };\n\n      /**\n       * 数据查询\n       **/\n      const handleQuery = () => {\n        axios.get(\"/doc/all/\" + route.query.ebookId).then((response) => {\n          const data = response.data;\n          if (data.success) {\n            docs.value = data.content;\n\n            level1.value = [];\n            level1.value = Tool.array2Tree(docs.value, 0);\n\n            if (Tool.isNotEmpty(level1)) {\n              defaultSelectedKeys.value = [level1.value[0].id];\n              handleQueryContent(level1.value[0].id);\n              // 初始显示文档信息\n              doc.value = level1.value[0];\n            }\n          } else {\n            message.error(data.message);\n          }\n        });\n      };\n\n      const onSelect = (selectedKeys: any, info: any) => {\n        console.log('selected', selectedKeys, info);\n        if (Tool.isNotEmpty(selectedKeys)) {\n          // 选中某一节点时，加载该节点的文档信息\n          doc.value = info.selectedNodes[0].props;\n          // 加载内容\n          handleQueryContent(selectedKeys[0]);\n        }\n      };\n\n      // 点赞\n      const vote = () => {\n        axios.get('/doc/vote/' + doc.value.id).then((response) => {\n          const data = response.data;\n          if (data.success) {\n            doc.value.voteCount++;\n          } else {\n            message.error(data.message);\n          }\n        });\n      };\n\n      onMounted(() => {\n        handleQuery();\n      });\n\n      return {\n        level1,\n        html,\n        onSelect,\n        defaultSelectedKeys,\n        doc,\n        vote\n      }\n    }\n  });\n"]}]}